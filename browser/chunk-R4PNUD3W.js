import{g as f}from"./chunk-7U4M7FLE.js";import{a as u}from"./chunk-OQKDZ6KP.js";import{a as $}from"./chunk-CH6NKNWW.js";import{g as S,h as c}from"./chunk-PT3WFG3U.js";import{a as h}from"./chunk-MQPYQJ3G.js";import{ka as p,oa as y,va as g,wa as b}from"./chunk-AZ7G53RQ.js";import{Ya as i,_ as d,da as a,uc as r}from"./chunk-ZIXU4GN5.js";var n=$.APPRAISAL_API_URL+"/attitude-skill-indicator",m=class o{constructor(t){this.http=t}findByCriteriaPaginated(t){return this.http.post(n+"/findByCriteriaPaginated",t)}saveIndicator(t){return this.http.post(n+"/save",t)}getCategory(){return this.http.get(n+"/category/list")}getMetric(){return this.http.get(n+"/metric-type/list")}deleteIndicator(t){return this.http.delete(n+"/delete/"+t)}static \u0275fac=function(e){return new(e||o)(a(h))};static \u0275prov=d({token:o,factory:o.\u0275fac,providedIn:"root"})};var v=class o{constructor(t,e,s,l,k,A){this.spinnerService=t;this.attitudeSkillService=e;this.messageService=s;this.router=l;this.confirmationService=k;this.confirmDialog=A;this.init()}state={$dataList:i([]),$dataLoading:i(!1),$pagingInfo:i(new u),$totalRowCount:i(1),$selectedData:i(null),$selectedVerified:i(!0),$loading:i(!1),$disabledTable:i(!1),$selectedCategory:i(""),$searchText:i(""),$searchBtnClickEvent:i(!1),$optionsCategory:i([]),$optionsMetricType:i([]),$metricList:i([]),$disabledUpdate:i(!0),$disabledSave:i(!0),$disabledCancel:i(!0),$formMode:i("idle")};$dataList=this.state.$dataList.asReadonly();$dataLoading=this.state.$dataLoading.asReadonly();$selectedData=this.state.$selectedData.asReadonly();$cols=i([{header:"No",class_td:"!text-center",type:"number"},{field:"attitudeSkillCategory",header:"Category",class_td:"!text-center"},{field:"indicator",header:"Indicators",class_td:"!text-center"},{field:"metricType",header:"Metrics",class_td:"!text-center"},{field:"action",header:"Actions",class_td:"flex justify-center items-center gap-2",type:"action"}]).asReadonly();$pagingInfo=this.state.$pagingInfo.asReadonly();$totalRowCount=this.state.$totalRowCount.asReadonly();$searchText=this.state.$searchText.asReadonly();$filter=r(()=>{let t=null;t={};let e;return e=this.$searchText()??"",t.indicator=e,t});indicatorAttitudeForm=i(new S({category:new c({value:null,disabled:!0}),indicator:new c({value:null,disabled:!0}),metricType:new c({value:null,disabled:!0})}));$optionsCategory=this.state.$optionsCategory.asReadonly();$optionsMetricType=this.state.$optionsMetricType.asReadonly();$metricList=this.state.$metricList.asReadonly();$disabledSave=r(()=>this.state.$disabledSave()&&this.state.$formMode()=="idle");$disabledCancel=r(()=>this.state.$disabledCancel()&&this.state.$formMode()=="idle");$disabledTable=r(()=>this.state.$formMode()=="edit");$formMode=this.state.$formMode.asReadonly();ref;dialogOptions={modal:!0,styleClass:"w-11/12 md:w-5/12"};init(){this.setSpinner(),this.populateList(),this.generateCategory(),this.generateMetric()}setSpinner(){b(this.state.$loading).subscribe(t=>t?this.spinnerService.show():this.spinnerService.hide())}populateList(){this.state.$dataLoading.set(!0);let t={wrapper:this.$filter(),pagingInfo:this.state.$pagingInfo(),totalRowCount:this.state.$totalRowCount()};this.attitudeSkillService.findByCriteriaPaginated(t).subscribe(e=>{e.status&&(this.state.$pagingInfo.set(e.object.pagingInfo||new u),this.state.$dataList.set(e.object.dataList||[]),this.state.$totalRowCount.set(e.object.totalRowCount||0)),this.state.$dataLoading.set(!1)})}onLazyLoad(t){this.populateList()}generateCategory(){let t=[];this.attitudeSkillService.getCategory().subscribe(e=>{e.status&&e.object.map(s=>{t.push({value:s.id,label:s.name})})}),this.state.$optionsCategory.set(t)}generateMetric(){let t=[],e=[];this.attitudeSkillService.getMetric().subscribe(s=>{s.status&&s.object.map(l=>{t.push({value:l.id,label:l.name}),e.push(l)})}),this.state.$optionsMetricType.set(t),this.state.$metricList.set(e)}resetState(){this.state.$dataList.set([]),this.state.$dataLoading.set(!1),this.state.$selectedData.set(null),this.state.$loading.set(!1),this.state.$searchText.set(""),this.state.$searchBtnClickEvent.set(!1)}onSearchBtnClicked(t){this.state.$searchText.set(t),this.populateList()}onRefreshSearchClicked(){this.state.$searchText.set(""),this.state.$searchBtnClickEvent.set(!1),this.populateList()}onAddIndicator(){this.resetState(),this.state.$formMode.set("add")}editAction(t){this.state.$selectedData.set(t),this.state.$formMode.set("edit")}onSaveFormAdd(t){this.attitudeSkillService.saveIndicator(t).subscribe(e=>{e.status?(this.confirmDialog.confirm({message:`Berhasil ${this.state.$formMode()=="add"?"menambahkan":"update"} data indicator!`,header:"Info",key:"ok",icon:"pi pi-check-circle",accept:()=>this.state.$formMode.set("idle")}),this.populateList()):this.messageService.add({severity:"error",summary:"Error",detail:`Failed to ${this.state.$formMode()=="add"?"save":"update"} data.`})},e=>{this.messageService.add({severity:"warn",summary:"Perhatian",detail:`Error ${this.state.$formMode()=="add"?"save":"update"} data.`})})}onCancelFormAdd(){this.resetState(),this.state.$formMode.set("idle")}deleteAction(t){this.state.$selectedData.set(t),this.confirmationService.confirm({header:"Konfirmasi",message:"Apakah Anda yakin ingin menghapus indicator ini?",accept:()=>{this.attitudeSkillService.deleteIndicator(t.id).subscribe(e=>{if(e.status){let s=`Hapus data ${this.$selectedData()?.indicator} berhasil!`;this.messageService.add({severity:"success",summary:"Success",detail:s}),this.state.$formMode.set("idle"),this.state.$selectedData.set(null),this.populateList()}else this.messageService.add({severity:"error",summary:"Error",detail:e.message});this.populateList()})},reject:()=>{}})}static \u0275fac=function(e){return new(e||o)(a(g),a(m),a(y),a(f),a(p),a(p))};static \u0275prov=d({token:o,factory:o.\u0275fac})};export{v as a};
