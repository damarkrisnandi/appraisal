import{a as i,c as $}from"./chunk-FIPB3IW5.js";import{c as b,d as j,e as k,g as y}from"./chunk-E3XSTR4X.js";import{a as R}from"./chunk-YCTAA2SV.js";import{a as T,b as u}from"./chunk-RKENV64N.js";import{oa as M}from"./chunk-EL7CSRMH.js";import{B as d,I as c,Ic as S,O as I,W as v,Xa as l,Z as a,_ as g,ca as n,ia as h,v as f,z as p}from"./chunk-SAC5J3G4.js";var m=class t{constructor(e,r,o){this.router=e;this.activatedRoute=r;this.titleService=o;this.state.$menuTree.set(i.getItem("menus")),this.setTitlePage()}state={$menuTree:l([]),$pageTitle:l("")};$menuTree=this.state.$menuTree.asReadonly();setTitlePage(){this.router.events.pipe(c(e=>e instanceof j),p(()=>this.activatedRoute),p(e=>{for(;e.firstChild;)e=e.firstChild;return e}),c(e=>e.outlet==="primary"),d(e=>e.data)).subscribe(e=>{e.pageTitle?this.titleService.setTitle(`Appraisal > ${e.pageTitle} `):this.titleService.setTitle("Appraisal")})}resetState(){this.state.$menuTree.set([]),this.state.$pageTitle.set(null)}static \u0275fac=function(r){return new(r||t)(n(y),n(k),n(b))};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var A="tokenId",w=R.APPRAISAL_API_URL+"/auth",U=class t{constructor(e,r,o){this.userStore=e;this.menuTreeStore=r;this.http=o}isAuthenticated(){return!!this.tokenId}login(e){return this.loginService(e).pipe(v(r=>{r.status&&r.object?.jwtToken&&(this.setTokenId(r.object?.jwtToken),i.setItem("user",r.object),i.setItem("menus",this.featureToMenuItem(r.object?.role?.feature)))}))}featureToMenuItem(e){let r=[];for(let o of e){let s={};s.label=o.name,s.icon=o.icon,o.children&&(s.items=this.featureToMenuItem(o.children)),o.access_link&&(s.routerLink=o.access_link),r.push(s)}return r}loginService(e){return this.http.post(w+"/login",e)}forgotPassword(){}logout(){return this.logoutService().pipe(I(()=>{i.clear()}))}logoutService(){return f({})}setTokenId(e){i.setItem(A,e)}get tokenId(){return i.getItem(A)}static \u0275fac=function(r){return new(r||t)(n($),n(m),n(T))};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var te={"768px":{width:"calc(100% - 6px)",right:"3px",left:"3px"},"600px":{width:"calc(100% - 4px)",right:"2px",left:"12px"}};var C=(t,e)=>{if(i.getItem("tokenId")){let r=i.getItem("tokenId")||"";t=t.clone({headers:t.headers.set("Authorization",`Bearer ${r}`)})}return t=t.clone({headers:t.headers.set("Accept","*/*")}),e(t)};var H=(t,e)=>e(t);var P=class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=h({type:t});static \u0275inj=g({providers:[{provide:u,useValue:C,multi:!0},{provide:u,useValue:H,multi:!0},M],imports:[S]})};export{m as a,U as b,te as c,C as d,P as e};
