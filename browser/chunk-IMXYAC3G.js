import{g as $}from"./chunk-XNHUROM4.js";import{a as F}from"./chunk-OQKDZ6KP.js";import{a as L,d as o,i as a,n as I}from"./chunk-JHZUFCB2.js";import{a as f}from"./chunk-PCSHOGMI.js";import{ka as D,oa as S,va as E,wa as R}from"./chunk-LU7AHZRX.js";import{H as b,Xa as s,Z as u,a as y,b as v,ca as p,da as g}from"./chunk-LGYBJQJA.js";var d=class{noEmployee;fullName;userName;directorateId;divisionId;departmentId;unitId;positionId;levelId;status;projectMasterList=[]};var l=L.APPRAISAL_API_URL,m="/employee/",c=class r{constructor(e){this.http=e}getEmployeeList(e){return this.http.post(l+m+"findByCriteriaPaginated",e)}getDirectorateList(){return this.http.get(l+"/directorate/list")}getDivisionList(){return this.http.get(l+"/division/list")}getDepartmentList(){return this.http.get(l+"/department/list")}getPositionList(){return this.http.get(l+"/position/list")}getUnitList(){return this.http.get(l+"/unit/list")}getLevelList(){return this.http.get(l+"/level/list")}getStatusList(){return this.http.get(l+m+"status-list")}saveEmployee(e){return this.http.post(l+m+"save",e)}updateEmployee(e){return this.http.post(l+m+"update",e)}deleteEmployee(e){return this.http.delete(l+m+"delete/"+e)}static \u0275fac=function(t){return new(t||r)(p(f))};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};var C=class r{constructor(e,t,i,n,h){this.spinnerService=e;this.employeeService=t;this.router=i;this.confirmDialog=n;this.messageService=h;this.setSpinner(),this.setSearchCategory(),this.setupFormListeners(),this.populateList()}fb=g(I);state={$dataList:s([]),$dataLoading:s(!1),$selectData:s(null),$loading:s(!1),$pagingInfo:s(new F),$employeeWrapper:s(null),$totalRowCount:s(1),$optionsCategory:s([]),$selectedCategory:s(null),$searchText:s(""),$optionDirektorat:s([]),$optionDivision:s([]),$optionDepartment:s([]),$optionPosition:s([]),$optionUnit:s([]),$optionLevel:s([]),$optionStatus:s([]),$mode:s(null),$isRekamDisabled:s(!1),$isUbahDisabled:s(!1),$isSimpanDisabled:s(!1),$isHapusDisabled:s(!1),$isResetDisabled:s(!1)};$dataList=this.state.$dataList.asReadonly();$dataLoading=this.state.$dataLoading.asReadonly();$pagingInfo=this.state.$pagingInfo.asReadonly();$totalRowCount=this.state.$totalRowCount.asReadonly();$cols=s([{field:"noEmployee",header:"No Employee"},{field:"fullName",header:"Name"},{field:"directorateDescription",header:"Directorate"},{field:"divisionDescription",header:"Division"},{field:"departmentDescription",header:"Department"},{field:"positionDescription",header:"Position"},{field:"unitDescription",header:"Unit"},{field:"levelDescription",header:"Level"},{field:"status",header:"Status"}]).asReadonly();$optionDirektorat=this.state.$optionDirektorat.asReadonly();$optionDivision=this.state.$optionDivision.asReadonly();$optionDepartment=this.state.$optionDepartment.asReadonly();$optionPosition=this.state.$optionPosition.asReadonly();$optionUnit=this.state.$optionUnit.asReadonly();$optionLevel=this.state.$optionLevel.asReadonly();$optionStatus=this.state.$optionStatus.asReadonly();$optionsCategory=this.state.$optionsCategory.asReadonly();$selectedCategory=this.state.$selectedCategory.asReadonly();$searchText=this.state.$searchText.asReadonly();$employeeWrapper=this.state.$employeeWrapper.asReadonly();$selectData=this.state.$selectData.asReadonly();$mode=this.state.$mode.asReadonly();$isRekamDisabled=this.state.$isRekamDisabled.asReadonly();$isUbahDisabled=this.state.$isUbahDisabled.asReadonly();$isSimpanDisabled=this.state.$isSimpanDisabled.asReadonly();$isHapusDisabled=this.state.$isHapusDisabled.asReadonly();$isResetDisabled=this.state.$isResetDisabled.asReadonly();$employeeForm=s(this.fb.group({noEmployee:new a({value:null,disabled:!1},[o.required]),username:new a({value:"",disabled:!1},[o.required]),employeeName:new a({value:"",disabled:!1},[o.required]),directorate:new a({value:null,disabled:!1},[o.required]),division:new a({value:null,disabled:!0},[o.required]),department:new a({value:null,disabled:!0},[o.required]),position:new a({value:null,disabled:!0},[o.required]),unit:new a({value:null,disabled:!0},[o.required]),level:new a({value:null,disabled:!0},[o.required]),status:new a({value:null,disabled:!0},[o.required]),note:new a("")})).asReadonly();$searchForm=s(this.fb.group({category:new a({value:null,disabled:!1}),searchInput:new a({value:"",disabled:!1}),directorate:new a({value:null,disabled:!1}),division:new a({value:null,disabled:!1}),department:new a({value:null,disabled:!1}),position:new a({value:null,disabled:!1}),unit:new a({value:null,disabled:!1}),level:new a({value:null,disabled:!1})})).asReadonly();setSpinner(){R(this.state.$loading).subscribe(e=>e?this.spinnerService.show():this.spinnerService.hide())}populateList(){this.state.$dataLoading.set(!0),b(1e3).subscribe(()=>{this.setOptionDirektorat(),this.setOptionDivision(),this.setOptionDepartment(),this.setOptionPosition(),this.setOptionUnit(),this.setOptionLevel(),this.setStatusList(),this.btnCondition("default"),this.getEmployeeList(),this.state.$dataLoading.set(!1)})}setSearchCategory(){this.state.$optionsCategory.set([{label:"Semua",value:null},{label:"Username",value:"username"}])}setOptionDirektorat(){this.employeeService.getDirectorateList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionDirektorat.set(t)}else console.error("Failed to fetch directorate list:",e.message)},e=>{console.error("Error fetching directorate list:",e)})}setOptionDivision(){this.employeeService.getDivisionList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionDivision.set(t)}else console.error("Failed to fetch division list:",e.message)},e=>{console.error("Error fetching division list:",e)})}setOptionDepartment(){this.employeeService.getDepartmentList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionDepartment.set(t)}else console.error("Failed to fetch department list:",e.message)},e=>{console.error("Error fetching department list:",e)})}setOptionPosition(){this.employeeService.getPositionList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionPosition.set(t)}else console.error("Failed to fetch position list:",e.message)},e=>{console.error("Error fetching position list:",e)})}setOptionUnit(){this.employeeService.getUnitList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionUnit.set(t)}else console.error("Failed to fetch unit list:",e.message)},e=>{console.error("Error fetching unit list:",e)})}setOptionLevel(){this.employeeService.getLevelList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionLevel.set(t)}else console.error("Failed to fetch level list:",e.message)},e=>{console.error("Error fetching level list:",e)})}setStatusList(){this.employeeService.getStatusList().subscribe(e=>{if(e.status){let t=e.object.map(i=>({label:i.label,value:i.value}));this.state.$optionStatus.set(t)}else console.error("Failed to fetch status list:",e.message)},e=>{console.error("Error fetching status list:",e)}),this.state.$optionStatus.set([{label:"Active",value:1},{label:"Inactive",value:0}])}getEmployeeList(){this.state.$dataLoading.set(!0);let e={wrapper:this.state.$employeeWrapper(),pagingInfo:this.state.$pagingInfo(),totalRowCount:this.state.$totalRowCount()};this.employeeService.getEmployeeList(e).subscribe(t=>{if(t.status){let i=t.object.dataList;this.state.$dataList.set(i),this.state.$pagingInfo.set(t.object.pagingInfo),this.state.$totalRowCount.set(t.object.totalRowCount||0)}else console.error("Failed to fetch employee list.");this.state.$dataLoading.set(!1)},t=>{console.error("Error fetching employee list:",t)})}onLazyLoad(e){this.state.$pagingInfo.set(v(y({},this.$pagingInfo()),{currentPage:Math.floor(e.first/e.rows)+1,pageSize:e.rows})),this.getEmployeeList()}setupFormListeners(){let e=this.$employeeForm();e.get("directorate")?.valueChanges.subscribe(t=>{let i=e.get("division");t?i?.enable():this.resetForm(["division","department","position","unit","level","status"])}),e.get("division")?.valueChanges.subscribe(t=>{let i=e.get("department");t?i?.enable():this.resetForm(["department","position","unit","level","status"])}),e.get("department")?.valueChanges.subscribe(t=>{let i=e.get("position");t?i?.enable():this.resetForm(["position","unit","level","status"])}),e.get("position")?.valueChanges.subscribe(t=>{let i=e.get("unit");t?i?.enable():this.resetForm(["unit","level","status"])}),e.get("unit")?.valueChanges.subscribe(t=>{let i=e.get("level");t?i?.enable():this.resetForm(["level","status"])}),e.get("level")?.valueChanges.subscribe(t=>{let i=e.get("status");t?i?.enable():this.resetForm(["status"])})}resetForm(e){let t=this.$employeeForm();e.forEach(i=>{t.get(i)?.reset(),t.get(i)?.disable()})}resetSearchForm(e){let t=this.$searchForm();e.forEach(i=>{t.get(i)?.reset(),this.getEmployeeList()})}resetAllForm(){this.$employeeForm().reset({username:"",employeeName:"",directorate:null,division:null,department:null,position:null,unit:null,level:null,status:null}),this.toggleFormControls("disable"),this.state.$mode.set(null),this.state.$selectData.set(null),this.btnCondition("default")}onSetSelected(e){e?(this.state.$selectData.set(e),this.$employeeForm().patchValue({noEmployee:this.$selectData()?.noEmployee,username:this.$selectData()?.userName,employeeName:this.$selectData()?.fullName,directorate:this.$selectData()?.directorateId,division:this.$selectData()?.divisionId,department:this.$selectData()?.departmentId,position:this.$selectData()?.positionId,unit:this.$selectData()?.unitId,level:this.$selectData()?.levelId,status:this.$selectData()?.status}),this.toggleFormControls("disable")):(this.state.$selectData.set(null),this.btnCondition("default"),this.resetForm(["noEmployee","employeeName","directorate","division","department","position","unit","level","status"]))}toggleFormControls(e){let t=this.$employeeForm();switch(e){case"enable":this.state.$mode()==="1"?(t.get("noEmployee")?.enable(),t.get("employeeName")?.enable(),t.get("directorate")?.enable()):Object.keys(t.controls).forEach(i=>{t.get(i)?.enable()});break;case"disable":Object.keys(t.controls).forEach(i=>{t.get(i)?.disable()});break;default:console.error("Invalid action:",e)}}onRekamForm(){this.resetAllForm(),this.state.$mode.set("1"),this.toggleFormControls("enable"),this.router.navigate(["/employee-mapping/form"])}onBackClick(){this.onCancelForm(),this.router.navigate(["/employee-mapping"])}onUbahForm(){this.state.$mode.set("2"),console.log("Ubah Form"),this.toggleFormControls("enable"),this.router.navigate(["/employee-mapping/form"])}onViewForm(){this.state.$mode.set("3"),console.log("View Form"),this.toggleFormControls("disable"),this.router.navigate(["/employee-mapping/form"])}onHapusForm(){console.log("Hapus Form")}verifySaveForm(){let e=this.$employeeForm(),t=["noEmployee","employeeName","directorate","division","department","position","unit","level","status"],i={noEmployee:"No Employee",employeeName:"Employee Name",directorate:"Directorate",division:"Division",department:"Department",position:"Position",unit:"Unit",level:"Level",status:"status"};for(let n of t)if(e.get(n)?.value===void 0)return console.log("form.get(field)?.value ",e.get(n)?.value),alert(`${i[n]} tidak boleh kosong.`),!1;return!0}onSaveForm(){if(this.verifySaveForm()){let e=this.$employeeForm(),t=new d;t.userName=e.get("noEmployee")?.value,t.fullName=e.get("employeeName")?.value,t.noEmployee=e.get("noEmployee")?.value,t.directorateId=e.get("directorate")?.value,t.divisionId=e.get("division")?.value,t.departmentId=e.get("department")?.value,t.positionId=e.get("position")?.value,t.unitId=e.get("unit")?.value,t.levelId=e.get("level")?.value,t.status=this.$selectData()?.status?this.$selectData()?.status:e.get("status")?.value,this.state.$mode()==="1"?this.employeeService.saveEmployee(t).subscribe(i=>{i.status?(this.confirmDialog.confirm({message:"Berhasil Simpan data !",header:"Info",key:"ok",icon:"pi pi-exclamation-triangle",accept:()=>this.router.navigate(["/employee-mapping"])}),this.getEmployeeList()):console.error("Failed to save employee:",i.message)},i=>{console.error("Error saving employee:",i)}):this.state.$mode()==="2"&&this.employeeService.updateEmployee(t).subscribe(i=>{i.status?(this.confirmDialog.confirm({message:"Berhasil Edit data !",header:"Info",key:"ok",icon:"pi pi-exclamation-triangle",accept:()=>this.router.navigate(["/employee-mapping"])}),this.getEmployeeList()):this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update employee."})},i=>{this.messageService.add({severity:"warn",summary:"Perhatian",detail:"Error updating employee:"})})}}onDeleteEmployee(e){if(this.$selectData()){let t=this.$selectData()?.noEmployee;this.employeeService.deleteEmployee(t).subscribe(i=>{i.status?(alert("Employee deleted successfully."),this.getEmployeeList(),this.resetAllForm()):this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete employee "})},i=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete employee "})})}else this.messageService.add({severity:"warn",summary:"Perhatian",detail:"Pilih data yang akan dihapus."})}onCancelForm(){this.router.navigate(["/"])}btnCondition(e){switch(e){case"default":this.state.$isRekamDisabled.set(!1),this.state.$isUbahDisabled.set(!1),this.state.$isHapusDisabled.set(!1),this.state.$isSimpanDisabled.set(!1);break;case"ubah":this.state.$isResetDisabled.set(!0);break;case"lihat":this.state.$isSimpanDisabled.set(!0),this.state.$isResetDisabled.set(!0);break;default:console.error("Invalid action:",e)}}onSearchBy(){let e=this.$searchForm(),t=new d;t.userName=e.get("noEmployee")?.value,t.fullName=e.get("employeeName")?.value,t.noEmployee=e.get("noEmployee")?.value,t.directorateId=e.get("directorate")?.value,t.divisionId=e.get("division")?.value,t.departmentId=e.get("department")?.value,t.positionId=e.get("position")?.value,t.unitId=e.get("unit")?.value,t.levelId=e.get("level")?.value;let i={wrapper:t,pagingInfo:this.state.$pagingInfo(),totalRowCount:this.state.$totalRowCount()};this.employeeService.getEmployeeList(i).subscribe(n=>{if(n.status){let h=n.object.dataList;this.state.$dataList.set(h),this.state.$pagingInfo.set(n.object.pagingInfo),this.state.$totalRowCount.set(n.object.totalRowCount||0)}else this.messageService.add({severity:"warn",summary:"Perhatian",detail:"Failed to fetch employee list."})},n=>{this.messageService.add({severity:"warn",summary:"Perhatian",detail:"Error fetching employee list"})})}static \u0275fac=function(t){return new(t||r)(p(E),p(c),p($),p(D),p(S))};static \u0275prov=u({token:r,factory:r.\u0275fac})};export{C as a};
