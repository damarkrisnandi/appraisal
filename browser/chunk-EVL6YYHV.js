import{a as o,c as R}from"./chunk-4BUGHUHR.js";import{c as T,d as b,e as j,g as k}from"./chunk-XNHUROM4.js";import{a as M}from"./chunk-4DVHWJTQ.js";import{a as S,b as u}from"./chunk-PCSHOGMI.js";import{oa as y}from"./chunk-LU7AHZRX.js";import{B as f,Hc as h,I as c,O as d,W as I,Xa as l,Z as a,_ as g,ca as n,ia as v,z as p}from"./chunk-LGYBJQJA.js";var m=class t{constructor(e,r,i){this.router=e;this.activatedRoute=r;this.titleService=i;this.state.$menuTree.set(o.getItem("menus")),this.setTitlePage()}state={$menuTree:l([]),$pageTitle:l("")};$menuTree=this.state.$menuTree.asReadonly();setTitlePage(){this.router.events.pipe(c(e=>e instanceof b),p(()=>this.activatedRoute),p(e=>{for(;e.firstChild;)e=e.firstChild;return e}),c(e=>e.outlet==="primary"),f(e=>e.data)).subscribe(e=>{e.pageTitle?this.titleService.setTitle(`Appraisal > ${e.pageTitle} `):this.titleService.setTitle("Appraisal")})}resetState(){this.state.$menuTree.set([]),this.state.$pageTitle.set(null)}static \u0275fac=function(r){return new(r||t)(n(k),n(j),n(T))};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var x="tokenId",A=M.APPRAISAL_API_URL+"/auth",C=class t{constructor(e,r,i){this.userStore=e;this.menuTreeStore=r;this.http=i}isAuthenticated(){return!!this.tokenId}login(e){return this.loginService(e).pipe(I(r=>{r.status&&r.object?.jwtToken&&(this.setTokenId(r.object?.jwtToken),o.setItem("user",r.object),o.setItem("menus",this.featureToMenuItem(r.object?.role?.feature)))}))}featureToMenuItem(e){let r=[];for(let i of e){let s={};s.label=i.name,s.icon=i.icon,i.children&&(s.items=this.featureToMenuItem(i.children)),i.access_link&&(s.routerLink=i.access_link),r.push(s)}return r}loginService(e){return this.http.post(A+"/login",e)}forgotPassword(){}logout(){return this.logoutService().pipe(d(()=>{o.clear()}))}logoutService(){return this.http.post(A+"/logout",{})}setTokenId(e){o.setItem(x,e)}get tokenId(){return o.getItem(x)}static \u0275fac=function(r){return new(r||t)(n(R),n(m),n(S))};static \u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"})};var te={"768px":{width:"calc(100% - 6px)",right:"3px",left:"3px"},"600px":{width:"calc(100% - 4px)",right:"2px",left:"12px"}};var U=(t,e)=>{if(o.getItem("tokenId")){let r=o.getItem("tokenId")||"";t=t.clone({headers:t.headers.set("Authorization",`Bearer ${r}`)})}return t=t.clone({headers:t.headers.set("Accept","*/*")}),e(t)};var H=(t,e)=>e(t);var L=class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=v({type:t});static \u0275inj=g({providers:[{provide:u,useValue:U,multi:!0},{provide:u,useValue:H,multi:!0},y],imports:[h]})};export{m as a,C as b,te as c,U as d,L as e};
